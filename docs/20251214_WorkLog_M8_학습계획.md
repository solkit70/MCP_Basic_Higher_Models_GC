# WorkLog: M8 - 캡스톤 프로젝트 (학습 계획)

**Date**: 2025-12-14
**Milestone**: M8 - 캡스톤 프로젝트 (최종 마일스톤)
**Duration**: 예상 4시간
**Status**: 📋 계획 수립 완료

---

## 📊 현재 진행 상황 분석

### ✅ 완료된 마일스톤 (M1-M7)
- **M1**: MCP 개요와 핵심 개념 (2025-10-05)
- **M2**: 로컬 환경 세팅 (2025-10-12)
- **M3**: 기존 MCP 서버 탐색·평가·연결 (2025-10-19)
- **M4**: Simple Web App 스켈레톤 (2025-11-02)
- **M5**: 기존 MCP 서버를 웹앱에 통합 (2025-11-23)
- **M6**: 커스텀 MCP 서버 (2025-11-30)
- **M7**: 배포·문서화·공유 (2025-12-07) ✅ **직전 완료**

### 📁 기존 산출물
```
01-foundations/           # MCP 개념, 용어집
02-env-setup/            # 환경 설정 스크립트
03-discover-servers/     # Echo 서버 테스트
04-app-integration/      # FastAPI 앱 + stdio 어댑터
05-build-server/         # file_server.py (커스텀 MCP 서버)
06-deployment/           # Docker 컨테이너화
07-release-share/        # 종합 문서화 및 예제
```

### 🎯 전체 로드맵 진행률
- **완료**: 7/8 마일스톤 (87.5%)
- **오늘 목표**: M8 캡스톤 완료 → **100% 프로젝트 완성**

---

## 🎯 M8 학습 목표 및 개요

### 핵심 목표
로드맵 원본([GC_version/GC_docs/250921_roadmap_githubcopilot.md](../GC_version/GC_docs/250921_roadmap_githubcopilot.md))에 따르면:

> **M8. 캡스톤 (1일)**
> - **학습 목표**: "웹앱 + 기존 MCP 서버 + 커스텀 MCP 서버" 단일 시나리오 통합 데모 완성
> - **실습 과제**:
>   1. 사용자 가치 중심 유즈케이스 1개 구현(엔드투엔드 플로우)
>   2. 통합/계약 테스트 모두 통과, 회귀 테스트 스크립트 포함
>   3. 데모 스크립트/스크린샷/짧은 영상 가이드

### 선택한 시나리오: **실시간 모니터링 대시보드**

**시나리오 개요:**
- MCP 서버의 상태를 실시간으로 모니터링
- 성능 메트릭 수집 (응답 시간, 성공/실패율)
- 헬스 체크 대시보드 (API 엔드포인트)
- 서버 장애 감지 및 알림

**왜 이 시나리오인가?**
- 프로덕션 환경에서 실제로 필요한 기능
- M1~M7의 모든 학습 내용을 통합 활용
- 모니터링은 DevOps의 핵심 역량

---

## 📝 M8 상세 학습 계획

### Phase 1: 현재 시스템 이해 및 설계 (60분)

#### 1-1. 현재 시스템 파악 (20분)

**읽어야 할 파일:**

**아키텍처 이해:**
- `07-release-share/README.md` - 전체 프로젝트 구조
- `07-release-share/DEPLOYMENT_GUIDE.md` - 배포 방법
- `CHANGELOG.md` - M1~M7 변경 이력

**현재 구현 상태:**
- `04-app-integration/simple-webapp/app/main.py` - FastAPI 앱 구조
- `04-app-integration/simple-webapp/app/routers/mcp.py` - 기존 MCP 라우터
- `04-app-integration/simple-webapp/app/services/mcp_client.py` - MCP 클라이언트 (stdio adapter)
- `05-build-server/file_server.py` - 커스텀 MCP 서버

**테스트 현황:**
- `06-deployment/TEST_RESULTS.md` - M7 테스트 결과
- `07-release-share/EXAMPLES/` - 예제 코드 3개

#### 1-2. 모니터링 시스템 설계 (40분)

**설계할 컴포넌트:**

**1. 모니터링 데이터 모델**
```python
# 메트릭 데이터 구조
{
    "timestamp": "2025-12-14T10:30:00Z",
    "server_name": "file_server",
    "health_status": "ok" | "error" | "degraded",
    "response_time_ms": 45,
    "success_count": 150,
    "error_count": 2,
    "uptime_seconds": 3600,
    "tools": [
        {"name": "read_file", "calls": 100, "avg_latency_ms": 30},
        {"name": "list_files", "calls": 50, "avg_latency_ms": 60}
    ]
}
```

**2. 새로운 API 엔드포인트**
- `GET /monitoring/status` - 전체 시스템 상태 요약
- `GET /monitoring/metrics` - 성능 메트릭 조회
- `GET /monitoring/health/{server}` - 특정 서버 헬스 체크
- `GET /monitoring/history` - 히스토리 데이터 (선택)
- `POST /monitoring/reset` - 메트릭 리셋 (선택)

**3. 메트릭 수집기 (MetricsCollector)**
- 각 API 호출 시 메트릭 기록
- 성공/실패 카운트
- 응답 시간 추적
- 인메모리 저장 (간단하게)

**4. 헬스 체커 (HealthChecker)**
- 주기적으로 MCP 서버 상태 확인
- 타임아웃 감지
- 장애 상태 판단 로직

**설계 문서:**
- `08-capstone/DESIGN.md` 작성
- Mermaid 다이어그램으로 아키텍처 시각화
- API 명세 정의

---

### Phase 2: 모니터링 시스템 구현 (90분)

#### 2-1. 메트릭 수집 모듈 구현 (30분)

**생성할 파일:**
- `04-app-integration/simple-webapp/app/services/metrics_collector.py`

**구현 내용:**
```python
class MetricsCollector:
    """
    API 호출 메트릭을 수집하고 저장하는 클래스
    - 인메모리 저장 (딕셔너리)
    - 스레드 안전성 (Lock 사용)
    - 통계 계산 (평균, 합계, 카운트)
    """

    def record_call(self, tool: str, latency_ms: int, success: bool)
    def get_metrics(self) -> Dict[str, Any]
    def get_tool_stats(self, tool: str) -> Dict[str, Any]
    def reset_metrics(self)
```

**주요 기능:**
- 도구별 호출 횟수 추적
- 응답 시간 통계 (평균, 최소, 최대)
- 성공/실패 비율 계산
- 시간대별 통계 (선택)

#### 2-2. 헬스 체커 구현 (30분)

**생성할 파일:**
- `04-app-integration/simple-webapp/app/services/health_checker.py`

**구현 내용:**
```python
class HealthChecker:
    """
    MCP 서버의 헬스 상태를 주기적으로 확인
    - 백그라운드 스레드로 실행
    - 타임아웃 감지
    - 장애 상태 기록
    """

    def start_monitoring(self, interval_seconds: int = 30)
    def stop_monitoring(self)
    def get_health_status(self, server_name: str) -> Dict[str, Any]
    def get_all_health_status(self) -> List[Dict[str, Any]]
```

**주요 기능:**
- 주기적 헬스 체크 (기본 30초)
- 타임아웃 시 "degraded" 상태
- 연속 실패 시 "error" 상태
- 복구 감지 (error → ok)

#### 2-3. 모니터링 라우터 구현 (30분)

**생성할 파일:**
- `04-app-integration/simple-webapp/app/routers/monitoring.py`

**구현 내용:**
```python
@router.get("/monitoring/status")
async def get_system_status() -> SystemStatusResponse:
    """전체 시스템 상태 요약"""

@router.get("/monitoring/metrics")
async def get_metrics() -> MetricsResponse:
    """성능 메트릭 조회"""

@router.get("/monitoring/health/{server}")
async def get_server_health(server: str) -> HealthResponse:
    """특정 서버 헬스 체크"""

@router.post("/monitoring/reset")
async def reset_metrics() -> ResetResponse:
    """메트릭 리셋"""
```

**Response 모델 정의:**
- `SystemStatusResponse` - 전체 상태
- `MetricsResponse` - 메트릭 데이터
- `HealthResponse` - 헬스 상태

#### 2-4. 기존 MCP 라우터 통합 (선택, 시간 있으면)

**수정할 파일:**
- `04-app-integration/simple-webapp/app/routers/mcp.py`

**통합 내용:**
- 각 API 호출 시 MetricsCollector 호출
- 응답 시간 측정
- 성공/실패 기록

---

### Phase 3: 테스트 및 데모 준비 (60분)

#### 3-1. 통합 테스트 작성 (30분)

**생성할 파일:**
- `08-capstone/tests/test_monitoring_integration.py`

**테스트 시나리오:**
1. **메트릭 수집 테스트**
   - API 호출 후 메트릭이 기록되는지 확인
   - 통계 계산이 올바른지 확인

2. **헬스 체크 테스트**
   - MCP 서버 정상 상태 확인
   - 서버 중단 시 에러 상태 확인
   - 복구 감지 확인

3. **엔드투엔드 테스트**
   - `/monitoring/status` 응답 확인
   - `/monitoring/metrics` 데이터 확인
   - 여러 API 호출 후 메트릭 업데이트 확인

**테스트 프레임워크:**
- pytest 사용
- FastAPI TestClient 활용
- Mock/Fixture 적절히 사용

#### 3-2. 데모 스크립트 작성 (30분)

**생성할 파일:**
- `08-capstone/scripts/run_demo.ps1`

**데모 시나리오:**
```powershell
# 1. 서버 시작
Write-Host "Step 1: Starting MCP Web Application..."
# uvicorn 실행

# 2. 헬스 체크
Write-Host "Step 2: Checking system health..."
curl http://localhost:8000/monitoring/status

# 3. MCP 도구 호출 (여러 번)
Write-Host "Step 3: Calling MCP tools (generating metrics)..."
for ($i=0; $i -lt 10; $i++) {
    curl -X POST http://localhost:8000/mcp/actions/read_file -d '{"params":{"path":"test.txt"}}'
}

# 4. 메트릭 조회
Write-Host "Step 4: Viewing metrics..."
curl http://localhost:8000/monitoring/metrics

# 5. 시스템 상태 확인
Write-Host "Step 5: Final system status..."
curl http://localhost:8000/monitoring/status
```

**출력 캡처:**
- 각 단계의 JSON 응답 저장
- 로그 파일 생성 (`08-capstone/logs/demo_output.txt`)
- 스크린샷 준비

---

### Phase 4: 문서화 (60분)

#### 4-1. 캡스톤 문서 작성 (40분)

**생성할 파일:**

**1. `08-capstone/README.md`**
```markdown
# M8 Capstone: 실시간 모니터링 대시보드

## 개요
- 프로젝트 소개
- 시나리오 설명
- 주요 기능

## 아키텍처
- Mermaid 다이어그램
- 컴포넌트 설명
- 데이터 흐름

## 빠른 시작
- 설치 방법
- 실행 방법
- 테스트 방법

## API 엔드포인트
- /monitoring/status
- /monitoring/metrics
- /monitoring/health/{server}

## 데모
- 데모 스크립트 실행 방법
- 예상 결과
- 스크린샷
```

**2. `08-capstone/DEMO_GUIDE.md`**
```markdown
# 데모 실행 가이드

## 사전 준비
- 환경 요구사항
- 설정 확인

## 데모 시나리오
- Step-by-step 가이드
- 각 단계별 예상 결과
- 문제 해결

## 결과 분석
- 메트릭 해석
- 성능 분석
- 개선 제안
```

**3. `08-capstone/DESIGN.md`**
```markdown
# 모니터링 시스템 설계

## 요구사항
- 기능 요구사항
- 비기능 요구사항

## 아키텍처 결정
- 설계 선택 이유
- 대안 검토
- Trade-offs

## 구현 상세
- 클래스 다이어그램
- 시퀀스 다이어그램
- 데이터 모델
```

#### 4-2. WorkLog 작성 (20분)

**생성할 파일:**
- `docs/20251214_WorkLog_M8_Capstone.md`

**내용:**
- 오늘 작업 전체 기록
- Phase별 소요 시간
- 발견한 이슈/해결 방법
- 학습 내용 정리
- 프로젝트 회고
- 최종 소감

---

### Phase 5: 최종 검증 및 마무리 (30분)

#### 5-1. 통합 테스트 실행 (15분)

**검증 체크리스트:**

**기능 테스트:**
- [ ] `/monitoring/status` 정상 응답
- [ ] `/monitoring/metrics` 메트릭 데이터 반환
- [ ] `/monitoring/health/{server}` 헬스 상태 반환
- [ ] MCP 도구 호출 후 메트릭 업데이트 확인
- [ ] 에러 처리 정상 동작

**통합 테스트:**
- [ ] 모든 pytest 테스트 통과
- [ ] 데모 스크립트 정상 실행
- [ ] 로그 파일 생성 확인

**문서 검증:**
- [ ] README 가독성 및 완성도
- [ ] 모든 링크 작동
- [ ] 다이어그램 정상 표시
- [ ] 맞춤법 확인

#### 5-2. 프로젝트 완성 선언 (15분)

**최종 정리:**
1. CHANGELOG.md 업데이트 (M8 추가)
2. 07-release-share/README.md 업데이트 (M8 완료 반영)
3. Git 커밋 및 푸시
4. 프로젝트 완료 태그 (v1.0.0)

**회고:**
- M1~M8 전체 여정 정리
- 학습 성과
- 향후 개선 아이디어

---

## 📦 예상 산출물 목록

### 새로 생성될 폴더 및 파일

```
08-capstone/                                    (신규 폴더)
├── README.md                                   (캡스톤 개요)
├── DESIGN.md                                   (설계 문서)
├── DEMO_GUIDE.md                               (데모 가이드)
├── tests/
│   ├── test_monitoring_integration.py         (통합 테스트)
│   └── test_metrics_collector.py              (단위 테스트)
├── scripts/
│   ├── run_demo.ps1                           (데모 실행)
│   └── run_tests.ps1                          (테스트 실행)
└── logs/
    ├── demo_output.txt                        (데모 실행 로그)
    └── test_results.jsonl                     (테스트 결과)

04-app-integration/simple-webapp/app/
├── services/
│   ├── metrics_collector.py                   (신규 - 메트릭 수집)
│   └── health_checker.py                      (신규 - 헬스 체크)
└── routers/
    └── monitoring.py                           (신규 - 모니터링 라우터)

docs/
├── 20251214_WorkLog_M8_학습계획.md            (이 파일)
└── 20251214_WorkLog_M8_Capstone.md            (작업 완료 후 생성)

prompts/
└── prompt_20251214.txt                         (오늘 프롬프트)

루트:
├── CHANGELOG.md                                (업데이트 - M8 추가)
└── 07-release-share/README.md                 (업데이트 - M8 완료)
```

### 산출물 통계
- **총 폴더 수**: 1개 (08-capstone + 하위 폴더)
- **총 파일 수**: 약 15-20개
- **총 라인 수**: 약 2,000-2,500 라인
- **문서 파일**: 6개
- **코드 파일**: 8개
- **스크립트 파일**: 2개

---

## 🎓 학습 포인트 상세

### 1. 시스템 통합 (Integration)

**배울 내용:**
- 여러 컴포넌트를 하나의 시나리오로 통합
- 기존 코드 확장 (MCP 라우터에 모니터링 추가)
- 엔드투엔드 데이터 흐름 설계

**실무 적용:**
- 마이크로서비스 통합 패턴
- API Gateway 패턴
- 서비스 메시 개념

### 2. 모니터링 및 관찰성 (Observability)

**배울 내용:**
- 메트릭 수집 (Metrics)
- 헬스 체크 (Health Checks)
- 로깅 및 추적 (Logging & Tracing)

**실무 적용:**
- Prometheus, Grafana
- DataDog, New Relic
- OpenTelemetry

### 3. 비동기 및 백그라운드 작업

**배울 내용:**
- 백그라운드 스레드 관리
- 주기적 작업 스케줄링
- 스레드 안전성 (Thread Safety)

**실무 적용:**
- Celery, Redis Queue
- Kubernetes CronJob
- 비동기 이벤트 처리

### 4. 프로덕션 준비 (Production Readiness)

**배울 내용:**
- 성능 측정 및 최적화
- 에러 처리 및 복구
- 테스트 전략 (단위/통합/E2E)

**실무 적용:**
- SRE 원칙
- Chaos Engineering
- 12-Factor App

### 5. 프로젝트 완성 및 회고

**배울 내용:**
- 문서화 완성도
- 데모 및 프레젠테이션
- 프로젝트 회고 (Retrospective)

**실무 적용:**
- 애자일 회고
- 지속적 개선
- 지식 공유

---

## 🔧 기술 스택 및 도구

### 핵심 기술
- **Python 3.11+**: 메인 언어
- **FastAPI**: 웹 프레임워크
- **MCP Python SDK**: MCP 프로토콜 구현
- **Pydantic**: 데이터 검증

### 개발 도구
- **pytest**: 테스트 프레임워크
- **uvicorn**: ASGI 서버
- **Docker**: 컨테이너화
- **PowerShell**: 스크립트 자동화

### 모니터링 기술
- **메트릭 수집**: 인메모리 (딕셔너리)
- **헬스 체크**: 백그라운드 스레드
- **로깅**: Python logging 모듈
- **시각화**: JSON 응답 (향후 Grafana 연동 가능)

---

## ⚠️ 주의사항 및 제약

### 기술적 제약
1. **인메모리 저장**: 서버 재시작 시 메트릭 손실
   - 해결: 향후 Redis, PostgreSQL 연동 고려

2. **단일 프로세스**: 멀티 프로세스 환경 미지원
   - 해결: 향후 공유 메모리, 메시지 큐 사용

3. **백그라운드 스레드**: 복잡한 동시성 제어 필요
   - 해결: Lock, Queue 적절히 사용

### 시간 제약
- 총 4시간 내에 완성 목표
- 완벽함보다 완성도 우선
- 핵심 기능에 집중 (선택 기능은 시간 있으면)

### 테스트 범위
- 모든 엣지 케이스 커버 불가능
- 주요 시나리오 중심 테스트
- 회귀 테스트는 핵심 기능만

---

## 📚 참고 자료

### 모니터링 패턴
- [The Twelve-Factor App](https://12factor.net/)
- [Site Reliability Engineering (SRE)](https://sre.google/)
- [Observability Engineering](https://www.oreilly.com/library/view/observability-engineering/9781492076438/)

### FastAPI 모니터링
- [FastAPI Middleware](https://fastapi.tiangolo.com/tutorial/middleware/)
- [Background Tasks](https://fastapi.tiangolo.com/tutorial/background-tasks/)
- [Dependency Injection](https://fastapi.tiangolo.com/tutorial/dependencies/)

### 테스트 전략
- [pytest 문서](https://docs.pytest.org/)
- [Testing Best Practices](https://testdriven.io/)
- [Integration Testing](https://martinfowler.com/bliki/IntegrationTest.html)

---

## 🚀 다음 단계 (M8 완료 후)

### 즉시 가능한 확장
1. **WebSocket 실시간 모니터링**
   - 실시간 메트릭 스트리밍
   - 브라우저에서 대시보드 표시

2. **메트릭 영속성**
   - PostgreSQL 연동
   - 시계열 데이터 저장

3. **알림 시스템**
   - 임계값 초과 시 알림
   - 이메일, Slack 통합

### 장기 로드맵
1. **프론트엔드 대시보드**
   - React/Vue.js로 UI 구현
   - 차트 라이브러리 (Chart.js, D3.js)

2. **분산 추적 (Distributed Tracing)**
   - OpenTelemetry 통합
   - Jaeger, Zipkin

3. **멀티 서버 관리**
   - 여러 MCP 서버 동시 모니터링
   - 서버 그룹핑 및 필터링

4. **CI/CD 파이프라인**
   - GitHub Actions 자동화
   - 자동 테스트 및 배포

---

## ✅ 학습 시작 전 체크리스트

### 환경 확인
- [ ] M7 완료 확인 (2025-12-07)
- [ ] Python 3.11+ 설치 확인
- [ ] 가상환경 활성화 가능
- [ ] Docker 실행 가능 (선택)
- [ ] Git 상태 정리

### 파일 확인
- [ ] 07-release-share/README.md 존재
- [ ] 04-app-integration/simple-webapp/app/ 구조 확인
- [ ] 05-build-server/file_server.py 존재
- [ ] 06-deployment/Dockerfile 존재

### 도구 확인
- [ ] VS Code 또는 선호 IDE
- [ ] PowerShell 5.1+ (Windows)
- [ ] curl 또는 Postman (API 테스트)
- [ ] pytest 설치 가능

---

## 💡 성공 기준

### 기능적 성공
- [ ] 모든 모니터링 API 엔드포인트 동작
- [ ] 메트릭이 정확히 수집됨
- [ ] 헬스 체크가 올바르게 동작
- [ ] 에러 처리가 적절함

### 기술적 성공
- [ ] 테스트 커버리지 > 70%
- [ ] 모든 pytest 테스트 통과
- [ ] 데모 스크립트 정상 실행
- [ ] Docker 빌드 성공

### 문서적 성공
- [ ] README가 명확하고 완전함
- [ ] 설계 문서가 이해하기 쉬움
- [ ] 데모 가이드로 재현 가능
- [ ] WorkLog가 상세하고 정확함

### 학습적 성공
- [ ] MCP 전체 흐름 이해
- [ ] 모니터링 패턴 학습
- [ ] 통합 테스트 작성 능력
- [ ] 프로젝트 완성 경험

---

## 🎉 마무리

M8 캡스톤은 **MCP 학습 여정의 최종 정점**입니다.

지난 M1부터 M7까지의 모든 학습 내용을:
- ✅ M1: 개념 이해
- ✅ M2: 환경 구축
- ✅ M3: 서버 탐색
- ✅ M4: 웹앱 구축
- ✅ M5: 통합
- ✅ M6: 커스텀 서버
- ✅ M7: 배포 및 문서화

**M8에서 모두 통합**하여 실무에서 바로 사용할 수 있는 완성된 시스템을 만듭니다.

오늘 하루 동안 집중해서, **프로덕션 레디 MCP 모니터링 시스템**을 완성해 봅시다! 🚀

---

**작성자**: Claude Sonnet 4.5 (Anthropic)
**작성일**: 2025-12-14
**다음 WorkLog**: `20251214_WorkLog_M8_Capstone.md` (작업 완료 후 생성)
**최종 목표**: MCP 학습 프로젝트 100% 완성! 🎓
